% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/extract_deposition.R
\name{extract_deposition}
\alias{extract_deposition}
\title{Read HYSPLIT Binary Deposition Output via con2asc Conversion}
\usage{
extract_deposition(
  con2asc_path,
  input_bin_path,
  output_ascii_path,
  overwrite = FALSE
)
}
\arguments{
\item{con2asc_path}{Character string. The full path to the 'con2asc.exe'
executable.}

\item{input_bin_path}{Character string. The full path to the input HYSPLIT
binary concentration/deposition file (e.g., "path/to/output.bin").}

\item{output_ascii_path}{Character string. The desired full path for the
output ASCII file (e.g., "path/to/output.txt"). It's recommended to match
the name con2asc will create (e.g., use "path/to/output.bin.txt" if
input is "path/to/output.bin").}

\item{overwrite}{Logical. If TRUE, forces the recreation of the ASCII file
by running con2asc even if the output file already exists. Defaults to FALSE.}
}
\value{
A data frame (tibble) with columns: YEAR, MO, DA, HR, LAT, LON,
and Deposition (numeric). Rows with non-positive or NA deposition values
are filtered out.
}
\description{
This function converts a HYSPLIT binary concentration/deposition output file
(like 'cdump' or 'output.bin') to ASCII using the external 'con2asc.exe'
utility and then reads the resulting ASCII file into a tidy data frame.
}
\details{
Note: This function requires a working HYSPLIT installation and access to
the 'con2asc.exe' executable. The conversion step can be slow for large files.
}
\examples{
\dontrun{
# Example usage (default - don't overwrite):
deposition_df <- extract_deposition(
  con2asc_path = "C:/hysplit/exec/con2asc.exe",
  input_bin_path = "C:/hysplit_runs/run1/output.bin",
  output_ascii_path = "C:/hysplit_runs/run1/output.bin.txt"
)

# Example usage (force overwrite):
deposition_df_overwrite <- extract_deposition(
  con2asc_path = "C:/hysplit/exec/con2asc.exe",
  input_bin_path = "C:/hysplit_runs/run1/output.bin",
  output_ascii_path = "C:/hysplit_runs/run1/output.bin.txt",
  overwrite = TRUE
)

# Check the first few rows
head(deposition_df)

# Load sf and ggplot2 for plotting
library(sf)
library(ggplot2)

deposition_sf <- sf::st_as_sf(deposition_df,
                             coords = c("LON", "LAT"),
                             crs = 4326)

ggplot(deposition_sf) +
  geom_sf(aes(color = Deposition)) +
  scale_color_viridis_c() +
  theme_minimal()
}
}
